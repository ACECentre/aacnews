{% extends 'admin/model/list.html' %}

{% block head %}
    {{ super() }}
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
{% endblock %}

{% block body %}
    {{ super() }}

    <script type="text/javascript">
    $(document).ready(function() {
         window.added = false;
         $('table.filters').bind('DOMSubtreeModified', function(event){

            if ($('input[data-role="datepicker"]').is(':visible') == true && window.added != true) {
              window.added = true;
              $.ajax({
                type: "POST",
                url: "{{ url_for('postview.last_newsletter') }}",
                success: function(date) {
                  $(event.target).val(date + " 00:00");
                }
              });
            }
            if ($('input[data-role="datepicker"]').is(':visible') == false) {
              window.added = false;
            }

         });
    })
    </script>
{% endblock %}

